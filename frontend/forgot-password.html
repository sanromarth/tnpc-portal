<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta name="description" content="Reset your password for Sri GCSR College Training & Placement Portal.">
    <title>Forgot Password | Sri GCSR College</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="icon" href="assets/logos/sgcsr-logo.png" type="image/png">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#0B1D3A">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="assets/icons/icon-192.png">
    <link rel="stylesheet" href="css/design-system.css">
    <link rel="stylesheet" href="css/auth.css">
    <link rel="stylesheet" href="css/pwa-enhancements.css">
    <link rel="stylesheet" href="css/enterprise-upgrade.css">
    <style>
        .otp-step { display: none; }
        .otp-step.active { display: block; }
        .otp-input-group { display: flex; gap: 8px; justify-content: center; margin: 20px 0; }
        .otp-input-group input {
            width: 48px; height: 56px; text-align: center; font-size: 24px; font-weight: 700;
            background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.15);
            border-radius: 12px; color: #FBC02D; font-family: 'Inter', sans-serif;
            transition: all 0.25s;
        }
        .otp-input-group input:focus {
            outline: none; border-color: rgba(30,79,154,0.5);
            box-shadow: 0 0 0 3px rgba(30,79,154,0.2); background: rgba(255,255,255,0.1);
        }
        .step-indicator { display: flex; justify-content: center; gap: 8px; margin-bottom: 24px; }
        .step-dot { width: 10px; height: 10px; border-radius: 50%; background: rgba(255,255,255,0.15); transition: all 0.3s; }
        .step-dot.active { background: #FBC02D; transform: scale(1.2); }
        .step-dot.done { background: #2e7d32; }
        .timer-text { color: rgba(255,255,255,0.4); font-size: 13px; text-align: center; margin-top: 8px; }
        .resend-btn { background: none; border: none; color: #64b5f6; cursor: pointer; font-size: 13px; text-decoration: underline; font-family: 'Inter', sans-serif; }
        .resend-btn:disabled { color: rgba(255,255,255,0.2); cursor: not-allowed; text-decoration: none; }
        .success-animation { text-align: center; padding: 20px 0; }
        .success-icon { font-size: 48px; animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes popIn { 0% { transform: scale(0); } 100% { transform: scale(1); } }
    </style>
</head>
<body>

<div class="auth-container">
  <div class="auth-orb auth-orb-1"></div>
  <div class="auth-orb auth-orb-2"></div>

  <div class="auth-card">
    <a href="login.html" class="back-home">‚Üê Back to Login</a>

    <div class="logo-section">
      <img src="assets/logos/sgcsr-logo.png" alt="Sri GCSR College Logo">
      <p class="college-name">Sri GCSR College</p>
    </div>

    <h2>Reset Password</h2>

    <div class="step-indicator">
        <div class="step-dot active" id="dot1"></div>
        <div class="step-dot" id="dot2"></div>
        <div class="step-dot" id="dot3"></div>
    </div>

    <div id="errorMsg" class="error-msg"></div>

    <!-- Step 1: Enter Email -->
    <div class="otp-step active" id="step1">
        <p style="color:rgba(255,255,255,0.5);font-size:14px;text-align:center;margin-bottom:16px;">Enter your registered email to receive a verification code</p>
        <form id="emailForm">
            <div class="input-group">
                <span class="input-icon">üìß</span>
                <input type="email" id="resetEmail" placeholder="Email Address" required autocomplete="email">
            </div>
            <button type="submit">Send OTP</button>
        </form>
    </div>

    <!-- Step 2: Enter OTP -->
    <div class="otp-step" id="step2">
        <p style="color:rgba(255,255,255,0.5);font-size:14px;text-align:center;margin-bottom:8px;">Enter the 6-digit code sent to your email</p>
        <div class="otp-input-group" id="otpInputGroup">
            <input type="text" maxlength="1" class="otp-digit" data-index="0" inputmode="numeric" autocomplete="one-time-code">
            <input type="text" maxlength="1" class="otp-digit" data-index="1" inputmode="numeric">
            <input type="text" maxlength="1" class="otp-digit" data-index="2" inputmode="numeric">
            <input type="text" maxlength="1" class="otp-digit" data-index="3" inputmode="numeric">
            <input type="text" maxlength="1" class="otp-digit" data-index="4" inputmode="numeric">
            <input type="text" maxlength="1" class="otp-digit" data-index="5" inputmode="numeric">
        </div>
        <div class="timer-text" id="timerText">Resend available in <span id="countdown">60</span>s</div>
        <div style="text-align:center;margin-top:8px;">
            <button class="resend-btn" id="resendBtn" disabled onclick="resendOTP()">Resend OTP</button>
        </div>
        <button type="button" onclick="verifyOTP()" style="width:100%;margin-top:16px;padding:14px;background:linear-gradient(135deg,#1e4f9a,#2962aa);color:#fff;border:none;border-radius:12px;font-size:15px;font-weight:700;cursor:pointer;font-family:'Inter',sans-serif;transition:all 0.3s;">Verify OTP</button>
    </div>

    <!-- Step 3: New Password -->
    <div class="otp-step" id="step3">
        <p style="color:rgba(255,255,255,0.5);font-size:14px;text-align:center;margin-bottom:16px;">Create your new password</p>
        <form id="newPasswordForm">
            <div class="input-group">
                <span class="input-icon">üîí</span>
                <input type="password" id="newPassword" placeholder="New Password (min 6 characters)" required minlength="6" autocomplete="new-password">
                <button type="button" class="password-toggle" onclick="togglePassword('newPassword', this)" aria-label="Toggle password visibility">üëÅ</button>
            </div>
            <div class="input-group">
                <span class="input-icon">üîí</span>
                <input type="password" id="confirmPassword" placeholder="Confirm New Password" required minlength="6" autocomplete="new-password">
                <button type="button" class="password-toggle" onclick="togglePassword('confirmPassword', this)" aria-label="Toggle password visibility">üëÅ</button>
            </div>
            <button type="submit">Reset Password</button>
        </form>
    </div>

    <p class="auth-link">
      Remember your password? <a href="login.html">Login here</a>
    </p>
  </div>
</div>

<script src="js/api.js"></script>
<script src="js/forgot-password.js"></script>
<script>
function togglePassword(inputId, btn) {
    const input = document.getElementById(inputId);
    if (input.type === "password") { input.type = "text"; btn.textContent = "üôà"; }
    else { input.type = "password"; btn.textContent = "üëÅ"; }
}
</script>
<script src="js/pwa.js" defer></script>
</body>
</html>
